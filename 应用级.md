# 应用级
## 方案简介
移动推荐算法
### 整体方案简介
以移动电商平台的真实用户-商品行为数据为基础来构建商品推荐模型
### 分级任务简介
1. 完成基础的数据可视化
2. 简单的基于规则的预测
## 数据集说明
- 数据集大小
1.0GB
- 数据集来源
[阿里天池移动推荐离线赛][1]
## 工具说明
- CPU：Intel® Core™ i5-7300HQ Processor
- 内存：8GB
- 操作系统：Windows 10 
## 问题挑战
1. 大量数据导致程序运行速度缓慢，最后采用分块读取
2. 对大量数据进行去重，合并等操作仍不熟练
3. 没有对数据进行特征构建，仅仅使用了简单的规则预测，预测效果差强人意
## 成果展示
### 数据内容
20000用户的完整行为数据以及百万级的商品信息。数据包含两个部分。

| 字段 | 字段说明 | 提取说明 |
| ---  | -------- | -------- |
| user_id | 用户标识 | 抽样&字段脱敏 |
|  item_id | 商品标识 | 字段脱敏 |
| behavior_type | 用户对商品的行为类型 | 包括浏览、收藏、加购物车、购买，对应取值分别是1、2、3、4|
| item_category | 商品分类标识 | 字段脱敏 |
| time | 行为时间 | 精确到小时级别 |

第二个部分是商品子集（P）,表名为tianchi_fresh_comp_train_item，包含如下字段：

| 字段 | 字段说明 | 提取说明 |
| ---  | -------- | -------- |
|  item_id | 商品标识 | 字段脱敏 |
| item_category | 商品分类标识 | 字段脱敏 |

> 数据脱敏：指对某些敏感信息通过脱敏规则进行数据的变形，实现敏感隐私数据的可靠保护。在涉及客户安全数据或者一些商业性敏感数据的情况下，在不违反系统规则条件下，对真实数据进行改造并提供测试使用，如身份证号、手机号、卡号、客户号等个人信息都需要进行数据脱敏。

### 最终目标
通过训练数据建立推荐模型,预测12.19这一天用户在P上的购买情况。
### 评估指标
采用经典的精确度(precision)、召回率(recall)和F1值作为评估指标。具体计算公式如下：
![计算公式][2]  
其中PredictionSet为算法预测的购买数据集合，ReferenceSet为真实的答案购买数据集合。
### 数据可视化
在建立模型之前,我们先进行一些简单的可视化,对数据内涵进行初步挖掘。
#### 点击购买转化率(CTR)

> CTR（Click-Through-Rate）即点击通过率，是互联网广告常用的术语，指网络广告（图片广告/文字广告/关键词广告/排名广告/视频广告等）的点击到达率，即该广告的实际点击次数（严格的来说，可以是到达目标页面的数量）除以广告的展现量（Show content）。对于电商平台来说,即为购买数/操作总数。

```CTR = 购买数/操作总数 = 232579 / 23291027 = 0.009985776926023916 ≈ 1%```
即用户平均操作100次才会执行一次购买操作。
#### 用户行为统计
11月18-12月18，用户每日操作次数如下图：
![user][3]

可见用户操作只在双十二期间剧增，而其他操作较为均衡，这为我们下一步的操作提供思路。
#### 商品行为统计
11月18-12月18，商品每日操作次数如下图：
![product][4]

与我们上一步的结果相互印证。
#### 双十二考察
经过上面的分析，下面来考察12-11与12-12这两天，来观察用户在这两天内的操作习惯：
![double12][5]

可以看出用户操作的高峰期都在晚上9点到11点，而浏览（0号）的操作数都比其他操作（加购物车，收藏，购买）要多得多，但是这并不能体现双十二的特点，下面来特别观察购买操作。
![double12_2][6]

显然，双十二0点购买数与其他时段相比剧增，这正体现了双十二的特点。
### 基于规则的预测
#### 规则提出
根据生活常识，我们很容易就得出加购物车与购买操作有强关联性，于是我们提出一条规则：
```在 T 时间内加购物车而未购买的用户最终会选择购买```
接下来我们来确定这个最优参数T。
#### 数据分析
我们对数据中的加购物车、购买的时间做差，得到时间差，绘制出“加购物车-购买”时间差图：
![此处输入图片的描述][7]

由图可知，绝大部分用户“加购物车-购买”时间差都在20-30小时内，这里为简单起见，取T=一天24小时。则最终规则为：
`在12月18日加购物车而未购买的用户最终会在12月19日选择购买`
事实上这也符合我们的购物习惯。
#### 规则验证
导出预测集如下：

![excel][8]

将所生成的csv文件`tianchi_mobile_recommendation_predict.csv`提交阿里天池，得到F1评分如下：
![predict][9]

可见简单的方法效果并不算特别差。
## 心得体会
1. 初步学习了pandas，numpy，matplotlib等python数据分析库
2. 初步了解了数据可视化
3. 初步了解了数据分析的基本流程

  [1]: https://tianchi.aliyun.com/competition/entrance/231522/information
  [2]: https://gtms01.alicdn.com/tps/i1/TB1WNN4HXXXXXbZaXXXwu0bFXXX.png
  [3]: https://s2.ax1x.com/2019/05/21/EzUev4.png
  [4]: https://s2.ax1x.com/2019/05/21/EzaoTI.png
  [5]: https://s2.ax1x.com/2019/05/21/Ez0bfx.png
  [6]: https://s2.ax1x.com/2019/05/21/EzsUEQ.png
  [7]: https://s2.ax1x.com/2019/05/21/Ez63m8.png
  [8]: https://s2.ax1x.com/2019/05/21/Ez6DmT.jpg
  [9]: https://s2.ax1x.com/2019/05/21/Ezck3n.png
